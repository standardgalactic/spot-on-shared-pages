Cosmic simulation reveals how black holes grow and evolve