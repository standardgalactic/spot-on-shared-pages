400-year-old mystery of why early explosive produces purple smoke solved by academics