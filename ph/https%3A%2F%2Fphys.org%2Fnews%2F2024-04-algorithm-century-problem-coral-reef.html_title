New algorithm solves century-old problem for coral reef scientists