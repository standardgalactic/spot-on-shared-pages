High-resolution simulations provide new insights into how galaxies are formed