Taiwan cancels flights, shuts schools ahead of typhoon