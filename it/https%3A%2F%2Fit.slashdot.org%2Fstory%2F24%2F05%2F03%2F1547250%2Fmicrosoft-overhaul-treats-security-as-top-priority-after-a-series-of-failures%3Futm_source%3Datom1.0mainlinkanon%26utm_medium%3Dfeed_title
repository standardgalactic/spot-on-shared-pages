Microsoft Overhaul Treats Security as 'Top Priority' After a Series of Failures