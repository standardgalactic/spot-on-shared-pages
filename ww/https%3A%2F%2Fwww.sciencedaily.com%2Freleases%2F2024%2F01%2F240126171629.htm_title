How waves and mixing drive coastal upwelling systems