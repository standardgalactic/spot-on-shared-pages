How do neural networks learn? A mathematical formula explains how they detect relevant patterns