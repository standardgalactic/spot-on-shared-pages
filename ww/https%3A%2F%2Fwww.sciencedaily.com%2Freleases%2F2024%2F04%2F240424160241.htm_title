Diversity and productivity go branch-in-branch